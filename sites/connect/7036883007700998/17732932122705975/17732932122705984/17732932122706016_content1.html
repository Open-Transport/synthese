<?if&cond=<@roid@>&then=
<?imports&
  roid=<@roid@>&
  template=<{import&template=
  
	<ul class="breadcrumb">
	 <li><?link&target=/&text=Connect?> <span class="divider">/</span></li>
	 <li><?link&target=/client?> <span class="divider">/</span></li>
	 <h1><@name@> (import <@file_format@>)</h1>
	</ul>
	
	<@tabs["properties"]=Propriétés@>
	<@tabs["parameters"]=Paramètres par défaut@>
	<@tabs["run"]=Exécution@>
	<@tabs["doc"]=Documentation@>
	<@tabs["format"]=Format@>
	<@tab=<@tab?tab:"properties"@>@>
	
	<ul class="nav nav-tabs"><{tabs&template=
	 <li <@(tab==id)?" class=\"active\"":""@>><a href="#<@id@>" data-toggle="tab"><@value@></a></li>
	}></ul>

	<div class="tab-content">
	<div class="tab-pane <@(tab=="properties")?"active":""@>" id="properties">
	 <?form&
	   target=<@p@>&
	   a=ObjectUpdate&
	   actionParam_object_id=<@id@>&
	   roid=<@id@>&
	   class=form-horizontal&
	   tab=properties&
	 ?>
	  <div class="control-group">
	   <label class="control-label">Nom</label>
	   <div class="controls"><input type="text" class="input-medium" name="actionParam_field_name" value="<@name@>" /></div>
	  </div>
	     <div class="control-group">
	      <label class="control-label">Source de données</label>
	      <div class="controls">
	       <select name="actionParam_field_data_source_id">
	      	<option value="" <@data_source_id?"":"selected=\"true\""@>>(non défini)</option>
	        <?data_sources&template=<{data_source&template=
	        	<option value="<@id@>" <@(id==data_source_id)?"selected=\"true\"":""@>><@name@></option>
	        }>?>
	       </select>
	      </div>
	     </div>
		  <div class="control-group">
	   <label class="control-label">Import automatique actif</label>
	   <div class="controls">
	    <select name="actionParam_field_active" class="input-small">
	     <option value="1" <@active?"selected\=\"true\"":""@>>OUI</option>
	     <option value="0" <@active?"":"selected=\"true\""@>>NON</option>
	    </select>
	   </div>
	  </div>
	  <?if&cond=<@active@>&then=
		  <div class="control-group">
		   <label class="control-label">Secondes entre imports</label>
		   <div class="controls">
		    <input type="text" class="input-mini" name="actionParam_field_auto_import_delay" value="<@auto_import_delay@>" />
		   </div>
		  </div>
	  	  <div class="control-group">
		   <label class="control-label">Import à heure fixe</label>
		   <div class="controls">
		    <input type="text" class="input-mini" name="actionParam_field_auto_import_time" value="<@auto_import_time@>" />
		   </div>
		  </div>
	  ?>
	  <div class="control-group">
	   <label class="control-label">Emplacement des logs</label>
	   <div class="controls"><input type="text" class="input-medium" name="actionParam_field_log_path" value="<@log_path@>" /></div>
	  </div>
	  <div class="control-group">
	   <div class="controls"><button class="btn btn-warning">Enregistrer</button></div>
	  </div>
		 
	 </form>

	</div><div class="tab-pane <@(tab=="parameters")?"active":""@>" id="parameters">
	 <?form&
	   target=<@p@>&
	   a=ObjectUpdate&
	   actionParam_object_id=<@id@>&
	   roid=<@id@>&
	   class=form-horizontal&
	   tab=parameters&
	   actionParam_field_parameters=<@parameters@>&
	   form_id=update_parameters&
	 ?>
	  <#formats/<@file_format@>/form#>
	  <div class="control-group">
	   <div class="controls"><button class="btn btn-warning">Enregistrer</button></div>
	  </div>
	 </form>
	</div><div class="tab-pane <@(tab=="run")?"active":""@>" id="run">
	
	 <?if&cond=<@run_import@>&then=
	   <div class="well">
	    <h3>Résultat de l'exécution<@(run_import==1)?" (simulation)":""@></h3>
	    
	    <?ImportFunction&
	      import_id=<@id@>&
	      di=<@run_import-1@>&
	      repeat_parameters=1&
	    ?>
	    
	    <?if&cond=<@exceptions@>&then=
	  	<div class="alert"><strong>Exception</strong> <@exceptions@></div>
	    ?>
	   </div>
	 ?>
	
	 <?form&
	   target=<@p@>&
	   roid=<@id@>&
	   class=form-horizontal&
	   tab=run&
	 ?>
	  <#formats/<@file_format@>/form#>
	  <div class="control-group">
	   <label class="control-label">Simulation</label>
	   <div class="controls">
	    <label class="radio inline"><input name="run_import" type="radio" value="1" checked="true" /> OUI</label>
	    <label class="radio inline"><input name="run_import" type="radio" value="2" /> NON</label>
	   </div>
	  </div>
	  <div class="control-group">
	   <div class="controls"><button class="btn btn-danger">Exécuter import</button></div>
	  </div>
	 </form>
	 
	</div><div class="tab-pane <@(tab=="doc")?"active":""@>" id="doc">
	
	 <div>
	  <div class="pull-right btn btn-warning" id="doc_switch">Modifier</div>
	  <div class="pull-right btn btn-primary" style="display:none" id="doc_cancel">Annuler</div>
	  <div id="doc_view"><@documentation@></div>
	  <div id="doc_edit" style="display:none"><textarea id="mce_editor" class="mceEditor" save_url="/connect?a=ObjectUpdate\&actionParam_object_id=<@roid@>\&co=0\&nr=1"><@documentation@></textarea></div>
	 </div>

	</div><div class="tab-pane <@(tab=="format")?"active":""@>" id="format">
	
	 <#formats/<@file_format@>/doc#>
	 
	</div></div>
	
	<script type="text/javascript" src="/lib/tiny_mce/tiny_mce.js"></script>
	<script type="text/javascript" src="/connect/js/import.js"></script>

}>?>?>