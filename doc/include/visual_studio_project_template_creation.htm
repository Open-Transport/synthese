<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0054)http://www.carlosag.net/Articles/createVSTemplate.aspx -->
<HTML><HEAD id=ctl00_Head1><TITLE>Creating your own Visual Studio Project Template</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8"><LINK 
href="visual_studio_project_template_creation_fichiers/carlosag.css" 
type=text/css rel=stylesheet>
<META content="Customizing Visual Studio .NET Template" name=description>
<META content="Visual Studio .NET Templates" name=keywords>
<STYLE type=text/css media=print>#MenuTD {
	DISPLAY: none
}
</STYLE>

<META content="MSHTML 6.00.6000.16674" name=GENERATOR></HEAD>
<BODY>
<FORM id=aspnetForm name=aspnetForm action=createVSTemplate.aspx method=post>
<DIV><INPUT id=__VIEWSTATE type=hidden 
value=/wEPDwUKMTY1NDU2MTA1MmRkMZ8sINvIxRjUkXjwzxV4aLZuyCc= name=__VIEWSTATE> 
</DIV>
<DIV class=banner><IMG id=ctl00__logoImage 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
src="visual_studio_project_template_creation_fichiers/logo.gif"> &nbsp;&nbsp; 
<SPAN class=PageTitle>Creating your own Visual Studio Project Template</SPAN> 
</DIV>
<DIV class=bannerPath><SPAN class=HeaderText id=ctl00_siteMap><A 
href="http://www.carlosag.net/Articles/createVSTemplate.aspx#ctl00_siteMap_SkipLink"><IMG 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
height=0 alt="Skip Navigation Links" 
src="visual_studio_project_template_creation_fichiers/WebResource.gif" 
width=0></A><SPAN><A title=Home style="COLOR: white" 
href="http://www.carlosag.net/default.aspx">Home</A></SPAN><SPAN> &gt; 
</SPAN><SPAN><A style="COLOR: white" 
href="http://www.carlosag.net/Articles/default.aspx">Articles</A></SPAN><SPAN> 
&gt; </SPAN><SPAN style="FONT-WEIGHT: bold; COLOR: white">Creating your own VS 
Template</SPAN><A id=ctl00_siteMap_SkipLink></A></SPAN> <SPAN 
style="COLOR: white">&nbsp;&nbsp;|&nbsp;&nbsp;</SPAN><A class=HeaderText 
title="Send Email" href="mailto:web@carlosag.net">Contact</A>&nbsp;&nbsp; </DIV>
<DIV id=LeftPane>
<TABLE cellSpacing=0 cellPadding=0 width=202 border=0>
  <TBODY>
  <TR height=24>
    <TD class=MenuTop vAlign=center>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>&nbsp;&nbsp;<A class=MenuTitle 
            href="http://www.carlosag.net/Tools/default.aspx">Tools</A></TD>
          <TD align=right><IMG alt=Collapse 
            src="visual_studio_project_template_creation_fichiers/collapse.gif" 
            heigth="13">&nbsp;&nbsp;&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR height=11 width="202">
    <TD class=MenuBody></TD></TR>
  <TR vAlign=top>
    <TD class=MenuContent><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/WindowsLiveWriter/Default.aspx"><B>NEW!!!</B> 
      Windows Live Writer Code Colorizer Plugin</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/IisReports/Default.aspx"><B>NEW!!!</B> 
      IIS 7 Reports</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/MRUModule/Default.aspx"><B>NEW!!!</B> 
      IIS 7 MRU Module</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/CodeTranslator/Default.aspx">Code 
      Translator</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/WebChart/Default.aspx">WebChart 
      Control</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/CodeColorizer/Default.aspx">CodeColorizer</A><BR><IMG 
      height=7 src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/XGrid/Default.aspx">XGrid</A><BR><IMG 
      height=7 src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/XMap/Default.aspx">X-Map 
      Editor</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/ExcelXmlWriter/Default.aspx">ExcelXmlWriter</A><BR><IMG 
      height=7 src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/DbDiagrams/Default.aspx">DbDiagrams</A><BR><IMG 
      height=7 src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/ForumColorizer/Default.aspx">Forum 
      Colorizer</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Tools/UmlDiagrams/Default.aspx">UmlDiagrams</A><BR><IMG 
      height=7 src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/soon.aspx?id=1">Drawing Board</A><BR>
      <UL></UL></TD></TR>
  <TR height=13 width="202">
    <TD class=MenuBottom></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=202 border=0>
  <TBODY>
  <TR height=24>
    <TD class=MenuTop vAlign=center>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>&nbsp;&nbsp;<A class=MenuTitle 
            href="http://www.carlosag.net/Articles/default.aspx">Articles</A></TD>
          <TD align=right><IMG alt=Collapse 
            src="visual_studio_project_template_creation_fichiers/collapse.gif" 
            heigth="13">&nbsp;&nbsp;&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR height=11 width="202">
    <TD class=MenuBody></TD></TR>
  <TR vAlign=top>
    <TD class=MenuContent><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow1.gif" 
      width=14><A class=SelectedMenuLink 
      href="http://www.carlosag.net/Articles/createVSTemplate.aspx">Creating 
      your own VS Template</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/configureComPlus.aspx">Configuring 
      COM+</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WritingMatrixAddIns.aspx">Writing 
      Simple Matrix Add-Ins</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WebChartTutorial.aspx">Generating 
      Charts in ASP.NET</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/soon.aspx?id=2">Writing Data Add-Ins for 
      Matrix</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/soon.aspx?id=3">Writing Code Builders for 
      Matrix</A><BR>
      <UL></UL></TD></TR>
  <TR height=13 width="202">
    <TD class=MenuBottom></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=202 border=0>
  <TBODY>
  <TR height=24>
    <TD class=MenuTop vAlign=center>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>&nbsp;&nbsp;<A class=MenuTitle 
            href="http://www.carlosag.net/Articles/Whidbey.aspx">Whidbey</A></TD>
          <TD align=right><IMG alt=Collapse 
            src="visual_studio_project_template_creation_fichiers/collapse.gif" 
            heigth="13">&nbsp;&nbsp;&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR height=11 width="202">
    <TD class=MenuBody></TD></TR>
  <TR vAlign=top>
    <TD class=MenuContent><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WebParts/connectionsTutorial.aspx">WebParts 
      Connections</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WebParts/intranetSample.aspx">Intranet 
      Sample</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WebParts/whidbeyfaq.aspx">Some 
      FAQ</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WebParts/moreRealSample.aspx">Another 
      WebParts Sample</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WebParts/catalogPartSample.aspx">CatalogPart 
      WebPart Sample</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Articles/WebParts/webPartsTransformers.aspx">Connection 
      Transformers</A><BR>
      <UL></UL></TD></TR>
  <TR height=13 width="202">
    <TD class=MenuBottom></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=202 border=0>
  <TBODY>
  <TR height=24>
    <TD class=MenuTop vAlign=center>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>&nbsp;&nbsp;<A class=MenuTitle 
            href="http://www.carlosag.net/Games/default.aspx">Games</A></TD>
          <TD align=right><IMG alt=Collapse 
            src="visual_studio_project_template_creation_fichiers/collapse.gif" 
            heigth="13">&nbsp;&nbsp;&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR height=11 width="202">
    <TD class=MenuBody></TD></TR>
  <TR vAlign=top>
    <TD class=MenuContent><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Games/Sudoku.aspx"><B>NEW!!!</B> 
      Sudoku</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Games/Domino.aspx">Domino</A><BR><IMG 
      height=7 src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Games/Backgammon.aspx">Backgammon</A><BR><IMG 
      height=7 src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/Games/Connect4.aspx">Connect4</A><BR>
      <UL></UL></TD></TR>
  <TR height=13 width="202">
    <TD class=MenuBottom></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=202 border=0>
  <TBODY>
  <TR height=24>
    <TD class=MenuTop vAlign=center>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>&nbsp;&nbsp;<A class=MenuTitle 
            href="http://www.carlosag.net/mobile/default.aspx">Windows 
          Mobile</A></TD>
          <TD align=right><IMG alt=Collapse 
            src="visual_studio_project_template_creation_fichiers/collapse.gif" 
            heigth="13">&nbsp;&nbsp;&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR height=11 width="202">
    <TD class=MenuBody></TD></TR>
  <TR vAlign=top>
    <TD class=MenuContent><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/mobile/Sudoku.aspx"><B>NEW!!!</B> Sudoku 
      Mobile</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/mobile/Tetris.aspx"><B>NEW!!!</B> Tetris 
      Mobile</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/mobile/Backgammon.aspx"><B>NEW!!!</B> 
      Backgammon Mobile</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/mobile/Connect4.aspx"><B>NEW!!!</B> Connect4 
      Mobile</A><BR>
      <UL></UL></TD></TR>
  <TR height=13 width="202">
    <TD class=MenuBottom></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=202 border=0>
  <TBODY>
  <TR height=24>
    <TD class=MenuTop vAlign=center>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>&nbsp;&nbsp;<A class=MenuTitle 
            href="http://www.carlosag.net/default.aspx?id=0">Home</A></TD>
          <TD align=right><IMG alt=Collapse 
            src="visual_studio_project_template_creation_fichiers/collapse.gif" 
            heigth="13">&nbsp;&nbsp;&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR height=11 width="202">
    <TD class=MenuBody></TD></TR>
  <TR vAlign=top>
    <TD class=MenuContent><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/default.aspx?id=1">Home</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink href="http://www.carlosag.net/blog.aspx">My 
      Blog</A><BR><IMG height=7 
      src="visual_studio_project_template_creation_fichiers/arrow.gif" 
      width=14><A class=MenuLink 
      href="http://www.carlosag.net/aboutme.aspx">About Me</A><BR>
      <UL></UL></TD></TR>
  <TR height=13 width="202">
    <TD class=MenuBottom></TD></TR></TBODY></TABLE><BR><IMG style="CURSOR: hand" 
onclick="document.getElementById('paypal').submit();" 
alt="Make payments with PayPal - it's fast, free and secure!" 
src="visual_studio_project_template_creation_fichiers/donation.png" border=0 
name=submit> </DIV>
<DIV id=RightPane>
<SCRIPT type=text/javascript><!--
google_ad_client = "pub-0489048774518319";
/* 120x600, created 6/7/08 */
google_ad_slot = "2553898952";
google_ad_width = 120;
google_ad_height = 600;
//-->
</SCRIPT>

<SCRIPT src="visual_studio_project_template_creation_fichiers/show_ads.js" 
type=text/javascript>
</SCRIPT>
</DIV>
<DIV id=ContentPane>
<H2>Creating your own Visual Studio Project Template</H2><BR>March 2004 
<BR><B>Summary:</B> This article explains how you can customize Visual Studio to 
have your own Project Template <BR>
<H2>Contents</H2>
<P><A href="http://www.carlosag.net/Articles/createVSTemplate.aspx#introduction" 
target=_self>Introduction</A><BR><A 
href="http://www.carlosag.net/Articles/createVSTemplate.aspx#vsdir" 
target=_self>Creating the VSDIR</A><BR><A 
href="http://www.carlosag.net/Articles/createVSTemplate.aspx#vsz" 
target=_self>Creating the VSZ</A><BR><A 
href="http://www.carlosag.net/Articles/createVSTemplate.aspx#items" 
target=_self>Adding Items to the Project</A><BR><A 
href="http://www.carlosag.net/Articles/createVSTemplate.aspx#summary" 
target=_self>Configuring Components</A><BR></P><BR>
<H2><A name=#introduction>Introduction</A></H2>Visual Studio is a great editor 
and comes with a lot of templates pre-defined to fit almost all needs. However 
in some cases you need more specific things or you could save some time by 
genearting some default content that you use. <BR>VS has an extensibility story 
so robust that it can allow you to do almost anything you can imagine with it. 
<BR>In this article we are just going to touch the simplest approach on 
generating your own project template by leveraging the existing infrastructure 
of the VS Wizard, later in the month I might write something on how to write 
your own wizard, to customize even further providing your own UI and more 
powerful options. <BR>Customizing the VS Wizard requires the following steps: 
<UL>
  <LI>Creating or modifying a VSDIR file 
  <LI>Creating a VSZ file 
  <LI>Customizing the default javascripts 
  <LI>Creating your file templates </LI></UL><BR><BR><BR>
<H2><A name=#vsdir>Creating the VSDIR file</A></H2>Visual Studio uses VSDIR 
files to load the information of the Add Items dialog and the New Project dialog 
box. The VSDIR provides information about the items these dialog boxes display, 
such as the names, descriptions, and the icon to display.<BR>&nbsp;<BR>You can 
have multiple VSDIR files in a single directory; however, generally one VSDIR 
file is used to contain information for multiple wizards, folders, or 
templates.<BR><A 
href="http://msdn.microsoft.com/library/en-us/vsintro7/html/vxconVSDirFiles.asp">http://msdn.microsoft.com/library/en-us/vsintro7/html/vxconVSDirFiles.asp</A><BR>&nbsp;<BR>
<H3>Creating the VSDIR file</H3>
<UL>
  <LI>Go to the path<BR><B>&lt;Program Files&gt;\Microsoft Visual Studio .NET 
  2003\VC#\CSharpProjects</B><BR>
  <LI>Create a file called MyTemplate.vsdir with the following content:<BR>
  <DIV class=code>MyTemplate.vsz|{FAE04EC1-301F-11d3-BF4B-00C04F79EFBC}|My 
  Template|10|This is a project template for creating my own 
  things|{FAE04EC1-301F-11d3-BF4B-00C04F79EFBC}|4548||MyTemplate<BR></DIV>Note: 
  This is a one singe line file. &nbsp;<BR></LI></UL>The information added in the 
VSDIR file has the following information:<BR>
<TABLE cellPadding=0 border=1>
  <TBODY>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Field</SPAN></B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana"></SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Meaning</SPAN></B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana"></SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">RelPathName</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Name of the 
      .vsz file for the wizard.</SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">{clsidPackage}</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Optional GUID 
      representing a product that has a DLL containing localized 
      resources.</SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">LocalizedName</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Optional name 
      of the wizard as it will appear in the Add Item dialog can be a string or 
      a resource identifier of the form: "#ResID." </SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">SortPriority</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">An integer 
      representing the relative priority of the wizard, with 1 being highest. 
      Determines the sort order of items in the dialog.</SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Description</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Localizable 
      description of the template or wizard as it will appear in the Add Item 
      dialog box can be a string or a resource identifier of the form: "#ResID." 
      </SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">DLLPath or 
      {clsidPackage}</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Used to load an 
      icon for the wizard from a .dll or .exe file. Specify either the full path 
      to the .dll or .exe, or a GUID of a product that has a .dll file 
      containing localized resources.</SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">IconResourceId</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Optional 
      resource identifier within the .dll file that determines the icon to 
      display. If no icon is defined, the shell substitutes the default icon for 
      a file with the same extension as the item.</SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Flags</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">A group of 
      flags that disable or enable the Name and Location fields on the Add Item 
      dialog box. The flags can have the following values: </SPAN><BR><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Space (" "): 
      enable file name</SPAN><BR><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">8192:&nbsp;&nbsp;&nbsp;disable 
      file name</SPAN><BR></TD></TR>
  <TR>
    <TD style="WIDTH: 20%" vAlign=top width="20%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">SuggestedBaseName</SPAN><BR></TD>
    <TD style="WIDTH: 80%" vAlign=top width="80%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">The default 
      name for the wizard either a string or a resource identifier of the form: 
      "#ResID." If necessary, the shell appends the base value with an integer 
      to make the name unique. For example, the shell might change MyFile.asp to 
      MyFile1.asp. </SPAN><BR><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">This default 
      name is shown in the name field in the 
dialog.</SPAN><BR></TD></TR></TBODY></TABLE>
<H2><A name=#vsz>Creating the VSZ file</A></H2><A 
href="http://msdn.microsoft.com/library/en-us/vsintro7/html/vxconVSZFiles.asp">http://msdn.microsoft.com/library/en-us/vsintro7/html/vxconVSZFiles.asp</A><BR>
<UL>
  <LI>Go to the path<BR><B>&lt;Program Files&gt;\Microsoft Visual Studio .NET 
  2003\VC#\CSharpProjects</B><BR>
  <LI>Create a file called MyTemplate.vsz with the following content:<BR>
  <DIV class=code><BR>VSWIZARD 
  7.0<BR>Wizard=VsWizard.VsWizardEngine.7.1<BR>Param="WIZARD_NAME = 
  MyTemplate"<BR>Param="WIZARD_UI = FALSE"<BR>Param="PROJECT_TYPE = 
  CSPROJ"<BR></DIV>&nbsp;<BR></LI></UL>The information on this file tells Visual 
Studio which component (ProgID for the wizard) to use and you can also specify 
wizard specific parameters to pass to the object.<BR>
<TABLE cellPadding=0 border=1>
  <TBODY>
  <TR>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 25%; PADDING-TOP: 3.75pt" 
    vAlign=top width="25%"><B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Part</SPAN></B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana"></SPAN><BR></TD>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 75%; PADDING-TOP: 3.75pt" 
    vAlign=top width="75%"><B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Meaning</SPAN></B><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana"></SPAN><BR></TD></TR>
  <TR>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 25%; PADDING-TOP: 3.75pt" 
    vAlign=top width="25%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">VSWIZARD</SPAN><BR></TD>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 75%; PADDING-TOP: 3.75pt" 
    vAlign=top width="75%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Identifies the 
      wizard interface the wizard will be expected to 
implement.</SPAN><BR></TD></TR>
  <TR>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 25%; PADDING-TOP: 3.75pt" 
    vAlign=top width="25%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Wizard</SPAN><BR></TD>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 75%; PADDING-TOP: 3.75pt" 
    vAlign=top width="75%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">The ProgID of 
      the wizard.</SPAN><BR></TD></TR>
  <TR>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 25%; PADDING-TOP: 3.75pt" 
    vAlign=top width="25%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Param</SPAN><BR></TD>
    <TD 
    style="PADDING-RIGHT: 3.75pt; PADDING-LEFT: 3.75pt; PADDING-BOTTOM: 3.75pt; WIDTH: 75%; PADDING-TOP: 3.75pt" 
    vAlign=top width="75%"><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Custom 
      parameters that get passed to the wizard upon execution. You can have any 
      number of custom parameters. </SPAN><BR><SPAN 
      style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Verdana">Each parameter 
      is contained on a separate line. 
</SPAN><BR></TD></TR></TBODY></TABLE>&nbsp;<BR>&nbsp;<BR>In this case we are 
using the already implemented VsWizard object. This by default will look for a 
folder to add the items and some scripts that can extend the 
functionality.<BR>&nbsp;<BR>But at this time you can already launch VS.NET 2003 
and be able to see a new Project called MyTemplate. You can notice that you get 
the same icon as the “Console Application”, which is the one I chose (4548) to 
simplify the sample, and also notice the suggested name for the project as well 
as the description,<BR><BR>
<CENTER><IMG height=366 
src="visual_studio_project_template_creation_fichiers/sampleTemplate.png" 
width=531><BR>&nbsp;</CENTER>&nbsp;<BR><B>Note:</B> If you try to use this new 
template it will show an error saying it couldn’t find the scripts. We will work 
to finish that in the next section.<BR>&nbsp;<BR>
<H2><A name=#items>Adding Items to the project</A></H2>The default wizard in 
Visual Studio uses the name of the template to look in the folder &lt;Program 
Files&gt;\Microsoft Visual Studio .NET 2003\VC#\VC#Wizards for the items to add 
and the script to extend the functionality of the project.<BR>&nbsp;<BR>
<H3>Create the Script</H3>Create the folder:<BR>&lt;Program Files&gt;Microsoft 
Visual Studio .NET 2003\VC#\VC#Wizards\MyTemplate<BR>Create the 
folder<BR>&lt;Program Files&gt;\Microsoft Visual Studio .NET 
2003\VC#\VC#Wizards\MyTemplate\Scripts\1033<BR>&nbsp;<BR>Inside this folder 
create a file called default.js with the following content:<BR><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">function</SPAN><SPAN> 
OnFinish(selProj, selObj) {</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">var</SPAN> oldSuppressUIValue = <SPAN 
style="COLOR: blue">true</SPAN>;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">try</SPAN> 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>oldSuppressUIValue = 
dte.SuppressUI;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">var</SPAN> strProjectPath = 
wizard.FindSymbol("PROJECT_PATH");</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">var</SPAN> strProjectName = 
wizard.FindSymbol("PROJECT_NAME");</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">var</SPAN> strSafeProjectName = 
CreateSafeName(strProjectName);</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>wizard.AddSymbol("SAFE_PROJECT_NAME", 
strSafeProjectName);</SPAN><BR><SPAN>&nbsp;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">var</SPAN> proj = 
CreateCSharpProject(strProjectName, strProjectPath, 
"default.csproj");</SPAN><BR><SPAN>&nbsp;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">var</SPAN> InfFile = 
CreateInfFile();</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">if</SPAN> (proj) 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>AddReferencesForClass(proj);</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>AddFilesToCSharpProject(proj, strProjectName, strProjectPath, InfFile, 
<SPAN 
style="COLOR: blue">false</SPAN>);</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>proj.Save();</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">catch</SPAN>(e) 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">if</SPAN>( e.description.length &gt; 0 
)</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>SetErrorInfo(e);</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">return</SPAN> 
e.number;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">finally</SPAN> {</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp; 
</SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>dte.SuppressUI = oldSuppressUIValue;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp; 
</SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">if</SPAN>( InfFile 
)</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>InfFile.Delete();</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN>}</SPAN><BR><SPAN>&nbsp;</SPAN><BR><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">function</SPAN><SPAN> 
GetCSharpTargetName(strName, strProjectName) 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">var</SPAN> strTarget = 
strName;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">switch</SPAN> (strName) 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">case</SPAN> 
"File1.cs":</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>strTarget = 
"Class1.cs";</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="COLOR: blue">break</SPAN>;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">return</SPAN> strTarget; 
</SPAN><BR><SPAN>}</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN><BR><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">function</SPAN><SPAN> 
DoOpenFile(strName) {</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">var</SPAN> bOpen = <SPAN 
style="COLOR: blue">false</SPAN>;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">switch</SPAN> (strName) 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">case</SPAN> 
"Class1.cs":</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>bOpen = <SPAN 
style="COLOR: blue">true</SPAN>;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="COLOR: blue">break</SPAN>;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">return</SPAN> bOpen; 
</SPAN><BR><SPAN>}</SPAN><BR><SPAN>&nbsp;</SPAN><BR><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">function</SPAN><SPAN> 
SetFileProperties(oFileItem, strFileName) 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">if</SPAN>(strFileName == "File1.cs") 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>oFileItem.Properties("SubType").Value = 
"Code";</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN>}</SPAN><BR>&nbsp;<BR>This script will be executed when 
creating the project and tells the wizard exactly what you what your project 
will do. I will explain the meaning of all this code in the next section, but 
for now, just copy/paste this code.<BR>&nbsp;<BR>
<H3>Create the Templates</H3>&nbsp;<BR>Create the folder:<BR>&lt;Program 
Files&gt;Microsoft Visual Studio .NET 2003\VC#\VC#Wizards\MyTemplate<BR>Create 
the folder<BR>&lt;Program Files&gt;\Microsoft Visual Studio .NET 
2003\VC#\VC#Wizards\MyTemplate\Templates\1033<BR>&nbsp;<BR>Iniside this folder 
create a file called Templates.inf with the following single line on 
it:<BR>File1.cs<BR>&nbsp;<BR>Iniside this folder create a file called File1.cs 
with the following code:<BR><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">namespace</SPAN><SPAN> 
[!output SAFE_NAMESPACE_NAME] 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: blue">using</SPAN> 
System;</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> </SPAN><SPAN 
style="COLOR: gray">&lt;summary&gt;</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> [!output 
SAFE_CLASS_NAME].</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> 
</SPAN><SPAN 
style="COLOR: gray">&lt;/summary&gt;</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">class</SPAN> [!output SAFE_CLASS_NAME] 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> 
</SPAN><SPAN 
style="COLOR: gray">&lt;summary&gt;</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> The main 
entry point for the 
application.</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> 
</SPAN><SPAN 
style="COLOR: gray">&lt;/summary&gt;</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">static</SPAN> <SPAN 
style="COLOR: blue">void</SPAN> 
<?xml namespace="namespace" prefix="st1" ?><ST1:PLACE 
w:st="on">Main</ST1:PLACE>(<SPAN style="COLOR: blue">string</SPAN>[] args) 
{</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="COLOR: green">//</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: green">// TODO: Add code to start application 
here</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="COLOR: green">//</SPAN></SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><BR><SPAN>}</SPAN><BR>&nbsp;<BR>&nbsp;<BR>At this point 
everything should work, and you should be able to create a project of your new 
template.<BR><BR>
<CENTER><IMG height=579 
src="visual_studio_project_template_creation_fichiers/sampleTemplate2.png" 
width=817><BR>&nbsp;</CENTER>&nbsp;<BR>&nbsp;<BR>
<H2>What the javascript code does</H2>OnFinish is called when the user press 
finish in the New Project dialog, inside this function, the only thing we do is 
read some of the “environment variables” that Visual Studio will pass us, 
including the path of the project and the name. <BR>Then we call a function 
called CreateCSharpProject; this function is shipped inside common.js 
(&lt;Program Files&gt;\Microsoft Visual Studio .NET 2003\VC#\VC#Wizards\1033) 
that does some default stuff like closing the solution if required (you can set 
the <SPAN>CLOSE_SOLUTION</SPAN> symbol for this before calling this method), 
then takes the specified TemplateFile, in this case default.csproj that setups 
the typical C# project with a Debug and Release folder inside the bin, etc. You 
can change this by creating another .csproj file inside the folder &lt;Program 
Files&gt;\Microsoft Visual Studio .NET 2003\VC#\VC#Wizards) and customizing it 
to cover your needs, in my case I have changed a couple of lines to add Setup 
releases with a new Setup &amp; Deployment Project as well as other debugging 
information.<BR>&nbsp;<BR>After creating the project, we call the CreateInfFile 
function (again in the common.js) that reads the Templates.inf file inside the 
Templates folder of the project and creates a copy in the %Temp% path, and 
returns a TextStream (from the Scripting.FileSystemObject ActiveX 
library).<BR>&nbsp;<BR>Then we call <SPAN>AddReferencesForClass</SPAN> 
(common.js) that will add the references to System, System.Data and System.XML 
assemblies.<BR>At the end we just call <SPAN>AddFilesToCSharpProject</SPAN> that 
will add the files inside the TextStream with the Templates.inf data.<BR>One 
thing to notice about this method is that it will call a function <SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">GetCSharpTargetName</SPAN> 
to determine the real name of each file. This is the reason we added that 
function to our script and just for demonstration purposes we “rename” the 
file1.cs to Class1.cs, but we could as well do nothing and return the same 
name.<BR>Once the file has beed added it will call 
<SPAN>SetFileProperties</SPAN> to set the correct properties for each file, in 
this case since it is code we are adding we set the SubType to code.<BR>After 
this it will call <SPAN>DoOpenFile</SPAN> to determine if the file should be 
opened by default in the editor.<BR><BR>
<H2><A name=#summary>Summary</A></H2>Customizing Visual Studio can be as easy as 
copying some files and adding a few others, or can be as powerful as creating 
your own dialogs, intercepting events in the editor, exposing custom actions, 
toolbars, buttons and more. <BR>In this article we used the simplest mechanism 
to extend the VS designer to create our own Project Template that adds our 
default content. <BR>This sample can be extended using the javascript common 
code to do a lot of things, but I wanted to keep as simple as possible.<BR>In a 
future article I will show how to create a new project template that intercepts 
events and creates a new Wizard to create projects in VS. </DIV>
<HR>
</FORM>Carlos Aguilar Mares © 2008 
<FORM id=paypal action=https://www.paypal.com/cgi-bin/webscr method=post><INPUT 
type=hidden value=_s-xclick name=cmd> <INPUT type=image 
alt="Make payments with PayPal - it's fast, free and secure!" 
src="visual_studio_project_template_creation_fichiers/donation.png" border=0 
name=submit> <INPUT type=hidden 
value="-----BEGIN PKCS7-----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-----END PKCS7-----&#13;&#10;" 
name=encrypted> </FORM></BODY></HTML>
