<project name="synthese" default="all" basedir=".">


  <typedef file="../buildlib.xml"/>


  <property file="../version.properties"/>

  <property name="version" value="3.0"/>
  <property name="lang" value="c++"/>

  <property file="../build.properties"/>


  <condition property="platform" value="posix">
    <or>
      <os family="unix"/>
      <os family="mac"/>
    </or>
  </condition>
  <condition property="platform" value="win32">
    <or>
      <os family="windows"/>
    </or>
  </condition>


  <target name="clean">
    <clean/>
  </target>


  <target name="all">

    <property name="goal" value="dist"/>
    
<!--     <clean/> -->
<!--     <sconsbuild/> -->
<!--     <deploy/> -->

   <basename property="distname" file="${target}"/>

   <property name="distdir"
   value="${dist.home}/${distname}_${platform}_${mode}"/>

   <if>
     <and>
       <equals arg1="${platform}" arg2="posix"/>
       <equals arg1="${mode}" arg2="release"/>
     </and>
     <then>
       <echo message="Stripping ${distdir}/${distname}"/>
       <exec executable="strip" failonerror="true" 
	    resolveexecutable="true" searchpath="true">
	<arg value="${distdir}/${distname}"/>
      </exec>       
     </then>
   </if>
   
   <delete file="${distdir}.zip"/> 
   <zip destfile="${distdir}.zip"> 

     <zipfileset filemode="755" dir="${dist.home}" 
		 includes="${distname}_${platform}_${mode}/${distname},
		           ${distname}_${platform}_${mode}/**/*.sh"/>

     <zipfileset dir="${dist.home}"
		 includes="${distname}_${platform}_${mode}/**"
		 excludes="${distname}_${platform}_${mode}/${distname},
		           ${distname}_${platform}_${mode}/**/*.sh"/>

   </zip>

  </target>








</project>

